<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Leaderboard</title>
  <link rel="stylesheet" href="assets/css/style.css"/>
  <script defer src="assets/js/app.js"></script>
  <!-- Ensure your leaderboard.js (the fetch + SSE file) exists at this path -->
  <script defer src="assets/js/leaderboard.js"></script>
</head>
<body>

<nav class="site">
  <div class="container inner">
    <a class="brand" href="index.html">
      <div class="logo">CS</div>
      <div>Indian Civic Sense</div>
    </a>
    <ul class="nav-links">
      <li><a href="upload.html">Report</a></li>
      <li><a href="gallery.html">Gallery</a></li>
      <li><a href="leaderboard.html">Leaderboard</a></li>
      <li><a href="contact.html">Contact</a></li>
    </ul>
    <div style="display:flex; gap:1rem; align-items:center">
        <!-- <div class="btn secondary"> -->
          <span id="nav-user" class="" style="display:none"></span>
        </div>
        <a class="btn secondary" href="login.html">Login</a>
        <!-- <a class="btn" href="register.html">Sign up</a> -->
      </div>
  </div>
</nav>

<!-- Removed IP references: user info and logout button logic -->
<script>
  (function(){
    const here = location.pathname.split('/').pop();
    document.querySelectorAll("nav a").forEach(a=>{
      if (a.getAttribute("href") === here) a.classList.add("active");
    });
  })();
</script>

<section style="padding:60px 0">
  <div class="container">
    <h2>Top Contributors</h2>

    <div style="display:flex; justify-content:space-between; align-items:center; gap:12px; margin-top:8px">
      <small class="muted">Live updates enabled (SSE) — fallback polling every 10s</small>
      <div>
        <label for="lb-limit" class="muted" style="font-size:0.9rem">Show top</label>
        <select id="lb-limit" style="margin-left:8px">
          <option value="10">10</option>
          <option value="25" selected>25</option>
          <option value="50">50</option>
        </select>
      </div>
    </div>

    <table class="table" style="margin-top:1rem">
      <thead>
        <!-- NOTE: Column "City" changed to "Contributor" because your model has reporterName -->
        <tr><th>Rank</th><th>City</th><th>Total</th><th>Active</th><th>Closed</th></tr>
      </thead>
      <tbody id="lb-body">
        <!-- placeholder while JS loads -->
        <tr id="lb-loading-row">
          <td colspan="5" style="text-align:center; padding:1rem">Loading leaderboard…</td>
        </tr>
      </tbody>
    </table>

    <p style="margin-top:.75rem; color:#98a1a8; font-size:.9rem">
      Tip: If you later add a `city` field to reports (or store a city when creating a report),
      the leaderboard can be switched to aggregate by city instead.
    </p>
  </div>
</section>

<script>
  // Wire limit select to the leaderboard script (if present)
  document.addEventListener('DOMContentLoaded', function () {
    const limitSelect = document.getElementById('lb-limit');
    limitSelect && limitSelect.addEventListener('change', function () {
      // If your leaderboard.js reads a query param "limit", update it here (or re-call fetch)
      if (window.__leaderboard && typeof window.__leaderboard.fetchLeaderboard === 'function') {
        // If your leaderboard script supports reading #lb-limit, it can use it on each fetch.
        window.__leaderboard.fetchLeaderboard();
      }
    });
  });
</script>

<!-- Removed IP.initLeaderboardPage reference -->

<footer>
  <div class="container grid">
    <div><strong>Indian Civic Sense</strong><br>
    <small class="muted">You see an issue, click a picture and report it on our website.</small></div>
    <div class="links">
      <a href="terms.html">Terms</a> ·
      <a href="legal.html">Legal</a>
    </div>
  </div>
</footer>

</body>
</html>
